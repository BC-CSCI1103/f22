# CSCI 1103 Computer Science 1 Honors

### Fall 2022

Robert Muller - Boston College

------

## Setting Up Your System

In this course, we'll be developing code in a Unix environment on either MacOS or under Windows. The instructions in this document work for recent versions of MacOS and for Windows 11 and recent Windows 10, Version 1903. If you have an older version of one of these operating systems, you'll need to upgrade your system before proceeding further with problem set 1. If you cannot upgrade for one reason or another, please get in touch with the instructor.

The coding environment that we're going to install has a lot of parts and the installation process involves many steps that have to be carried out carefully and exactly as specified. Some of the installation steps take a long time so set aside plenty of time for this work. If you run into problems with the installation process, please get in touch with a course staffer. Most of the installation steps will involve using a *command shell* to issue commands to the Unix operating system. Command shells may be new for you, but the Unix command shell is quite powerful and widely used so learning to work with it will be a good skill to develop in its own right.

### Work Flow

The basic flow of work for the course will be as follows. From time to time, you'll receive an email from GitHub Classroom with an invitation to accept a problem set. The email will look something like this:

![invite](./img/accept.png)

When you accept the invitation, GitHub Classroom will make a private copy of the problem set for you in a *repository* on GitHub and provide you with a URL link to that repo.

![ready](./img/ready.png)

So now you have your own *private* repository containing your copy of the problem set. Well, your repo is mostly private, it's shared only with the course staff. Your repo is hosted along with all of the others on our course GitHub site `https://github.com/BC-CSCI1103/`. If you visit that site, you'll see just a few repos, the ones that are privately owned by you and those that are public.

We'll come back to the discussion of the course workflow after we've set up the software on your computer.

## Setup for MacOS Monterey (12.0)

+ **If you're using a Windows system, skip this section -- scroll down to *Setup for Windows*.**
+ **If you're using a Mac running a much older version of MacOS such as MacOS Mojave (10.14), consider upgrading your operating system to Monterey, it's free in the App Store. **
+ **If you do upgrade your operating system, it's important that you complete that upgrade before following any of the steps below.**
+ **Respond affirmatively with a Y when queried by any installation step.**

---

### Setting up your Work Area

1. We're going to be using the MacOS **Terminal** application as our Unix command shell. We'll be using it often so it would be wise to copy the icon for the Terminal application

   <img src="./img/terminal-app-icon.png" width="80px" />

   to your taskbar. The Terminal icon can be found using the Finder. Select *Applications* (on the left) then scroll down and select *Utilities*, then scroll down to find Terminal. Drag the icon to the taskbar. Now fire up the terminal by selecting the icon. The window generated by the app is a Unix command shell. The command shell prompts the user for input. It will look something like ![this](./img/macoscmdprompt.png)

   the `rm:~\>` part at the bottom is the bash prompt. In the bash commands that follow, we'll omit the prompt to simplify cutting and pasting.

   <details><summary>Type <tt>echo $SHELL</tt> then hit the <tt>return</tt> key. If you see <tt>/bin/bash</tt>, press on. If you don't see <tt>/bin/bash</tt> open this detail.</summary>

   Your Terminal app is probably configured to run the **zsh** shell instead of  the **bash** shell.  You'll need to make an adjustment to cause it to run bash instead. Open *System Preferences* under the apple (upper left), select *Users & Groups*. <img src="./img/usersandgroups.png" width=450px><img src="./img/selectbash.png" width=450px>

   Unlock the lock (lower left, requires password) then control-click on your entry and select *Advanced Options*. Use the dropdown menu to select */bin/bash*. Select *Ok* then re-lock the *Users & Groups* panel.

   </details>

2. Most operating systems use a tree-structured hierarchy of *directories* (aka *folders*) for organizing resources. Directories and files can be addressed using *file paths*, sequences of directory names separated by the `/` character. For example, the path `/usr/local/bin/` addresses one of the directories that Unix uses for executable programs (aka, *binaries*).

   If you want to see what's in a given directory you can use the *list* command `ls path`. For example, the command

   ```bash
   ls /usr/local/
   ```

   shows

   ```bash
   Frameworks/  bin/    include/  n/              share/
   Library/     etc/    lib/      opt/            texlive/
   algs4/       go/     libexec/  remotedesktop/  var/
   ```

   Each user is assigned a *home directory* where they can organize their files and subdirectories. My home directory is located via the path`/Users/muller`. When a user is interacting with the operating system via a command shell, In addition to a home directory, the user will also have a *working directory*. The working directory will often change as commands are issued in the shell. We can see the current working directory using the *print working directory* command `pwd`:
   ```bash
   pwd
   ```
   In a fresh shell, this will show something like `/Users/muller` confirming that the working directory is initially set to the home directory. The *change directory* command `cd`,  when typed with just these two letters, will reset your working directory to the home directory.

   The *make directory* command `mkdir` makes a new directory in the current working directory. Let's make a work area for the materials developed in this class. We'll informally refer to this new directory as the *course home directory*.

   ```bash
   cd
   mkdir csci1103
   ```

   Done in this way, you can always navigate to our course home directory by typing

   ```bash
   cd
   cd csci1103
   ```

   Or equivalently in one line:

   ```bash
   cd ~/csci1103
   ```

   The tilde character `~` designates the path to your home directory.

### Setting up the OCaml Ecosystem

1. Install [MacPorts](https://www.macports.org/install.php), a utility for managing software packages on macOS.

   > Heads up! Do you already use another package manager such as Homebrew? If so, be aware that some of our course software doesn't work when supporting software has been installed with Homebrew. For the purposes of this course, please use MacPorts.

   After installing MacPorts, quit the Terminal app and fire it up again.

2. Use the newly installed MacPorts package manager to install OCaml's package manager [opam](https://opam.ocaml.org/), a graphics support library `lablgtk2` and a handy CLI utility called `tree`.

   > Heads up! 
   >
   > + MacPorts is invoked from the Unix command line as `port`. The `port` command writes files to privilege protected directories on your computer so it has to be run under the unix `sudo` command which prompts for a password. 
   > + Note that in the process of installing these programs, you may be asked to install the *XCode Command Line Utilities*. We'll need these tools so install them as directed.

   ```bash
   sudo port install opam lablgtk2 tree
   sudo port select --set python python310
   ```

3. Initialize `opam`. It's probably best to copy and paste the following two-command sequence -- the two quotation marks in the second command are backquotes (upper left, below the esc key). This command will not work if you type the normal single-quote marks.

   ```bash
   opam init
   eval `opam config env`
   ```

4. The installation script for OCaml's package manager `opam`, also installs the other main parts of the OCaml system. Fire up the OCaml interpreter to confirm that it's working.

5. 
   ```bash
   ocaml
   ```

   You should see something like:

   ```ocaml
   OCaml version 4.12
   #
   ```
   It's fine if you have OCaml 4.14 instead. You can type in expressions as you like, ending them with two consecutive semi-colons `;;`. Type `Ctrl-d` (i.e., hold down the `Control` key and while still holding it, type the `d` key) to exit the REPL.

6. Now use the Unix `git` command to retrieve some setup tools from our course site on GitHub.

   ```bash
   git clone https://github.com/BC-CSCI1103/setup.git   
   ```

7. Install various OCaml packages. This is taken care of for you in a `configure` script. Type exactly or cut and paste:

   ```bash
   cd ~/csci1103/setup
   ./configure
   ```

7. Install the [XQuartz](https://www.xquartz.org/) X-Window server.

8. Reboot your computer.

9. Test your OCaml setup. Type or cut and paste:

```bash
cd ~/csci1103/setup/test/stopNgo/src
dune exec bin/main.exe
```
<details><summary>If you see a simple animation, try hitting the touchpad a few times to start and stop. If you don't see the animation, open this detail.</summary>

   Something is wrong. Try copying and pasting the following two lines into the command shell:
   > ```bash
   > echo "eval $(opam env)" >> ~/.bash_profile
   > source ~/.bash_profile
   > ```
   >
   > Now try the `dune exec` command again. If it still doesn't work, contact a course staffer.

</details>

### Setting up your Editor

The last step in the MacOS-specific installation process is to set up your code editor. You're welcome to use any text/code editor that you like. In this course, we're using [vscode](https://code.visualstudio.com/) as the default editor. It's now one of the industry standards and is well adapted to developing code in OCaml. 

+ As you'll see, your instructor sometimes use the ancient and arcane but still-fantastic [emacs](https://www.gnu.org/software/emacs/) text editor. If you're feeling adventurous, give it a try! It's easy to install: `sudo port install emacs`.

#### Setting up vscode

1. Install the [vscode editor](https://code.visualstudio.com/download).

2. Like other modern editors, vscode can be customized in various ways. In vscode parlance, these customizations come packaged up in [Extensions](https://marketplace.visualstudio.com/vscode). Use the Visual Studio Marketplace to search for and install the [OCaml Platform Extension](https://marketplace.visualstudio.com/items?itemName=ocamllabs.ocaml-platform).

   <img src="./img/vscodeExtensionMarketplace.png"/>

   > The OCaml Platform Extension depends on the `ocaml-lsp-server` opam package. This was installed for you earlier in the `configure` step.

3. Fire up the vscode editor. This can be done either through the GUI by clicking on the vscode icon

   <img src="./img/vscodeIcon.png" width="100px"/>

   or better yet, by using the unix command shell. Type

   ```bash
   source ~/.bash_profile
   cd ~/csci1103/setup/test/stopNgo/src/
   code .
   ```

   > If this doesn't work, get in touch with course staff.

   Once vscode is running, you should see something like below. The red arrow is pointing to a blocky icon denoting vscode's Extension manager. Select it.

   <img src="./img/vscodeExtensions.png">

   OCaml Platform has been installed on your computer, now you'll need to search for it and install it into vscode.

   <img src="./img/vscodeInstallOCamlPlatform.png">Now close the Extension Manager by toggling its blocky icon (left), then open the file Explorer, its icon is top left. Also X-out the Get Started pane. You should see something like

   <img src="./img/vscodeStopNgo.png">You'll find your working OCaml source files by opening the `bin` directory (red arrow) and you can fire up a unix Terminal from within vscode by selecting the circled X at bottom left (yellow arrow). Stowing away the Explorer by toggling its icon should leave you with something like this:
   
   <img src="./img/vscodeStopNgoReady.png">Try typing that `dune exec` line to confirm that all is working. If you see this behavior, congrats you're good to go! Scroll down past the atom and Windows setup sections to **Finishing up the Workflow** below.

## Setting up Windows 

> Our setup will be nearly identical to the one used in Cornell's CS3110 class. Normally I write our instructions and double-check them against those of other schools. However, as of the time of this writing, I do not have a working Windows laptop. So I am going to explicitly copy many of the instructions and text from the Cornell site, with their permission.

---

*Start of Clarkson@Cornell 3110 Windows Setup Instructions*

### Windows

Unix development in Windows is made possible by the Windows Subsystem for Linux (WSL). If you have a recent version of Windows (build 20262, released November 2020, or newer), WSL is easy to install. If you don’t have that recent of a version, try running Windows Update to get it.

**Tip**

If you get an error about the “virtual machine” while installing WSL, you might need to enable virtualization in your machine’s BIOS. The instructions for that are dependent on the manufacturer of your machine. Try googling “enable virtualization [manufacturer] [model]”, substituting for the manufacturer and model of your machine. This [Red Hat Linux](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/virtualization_administration_guide/sect-virtualization-troubleshooting-enabling_intel_vt_and_amd_v_virtualization_hardware_extensions_in_bios) page might also help.

**With a recent version of Windows,** and assuming you’ve never installed WSL before, here’s all you have to do:

- Open Windows PowerShell as Administrator. To do that, click Start, type PowerShell, and it should come up as the best match. Click “Run as Administrator”, and click Yes to allow changes.
- Run `wsl --install`. (Or, if you have already installed WSL but not Ubuntu before, then instead run `wsl --install -d Ubuntu`.) When the Ubuntu download is completed, it will likely ask you to reboot. Do so. The installation will automatically resume after the reboot.
- You will be prompted to create a Unix username and password. You can use any username and password you wish. It has no bearing on your Windows username and password (though you are free to re-use those). Do not put a space in your username. Do not forget your password. You will need it in the future.

**Warning**

*Do not proceed* with these instructions if you were not prompted to create a Unix username and password. Something has gone wrong. Perhaps your Ubuntu installation did not complete correctly. Try uninstalling Ubuntu and reinstalling it through the Windows Start menu.

Now skip to the “Ubuntu setup” paragraph below.

**Without a recent version of Windows,** you will need to follow [Microsoft’s manual install instructions](https://docs.microsoft.com/en-us/windows/wsl/install-manual). WSL2 is preferred over WSL1 by OCaml (and WSL2 offers performance and functionality improvements), so install WSL2 if you can.

**Ubuntu Setup**

These rest of these instructions assume that you installed Ubuntu (20.04) as the Linux distribution. That is the default distribution in WSL. In principle other distributions should work, but might require different commands from this point forward.

Open the Ubuntu app. (It might already be open if you just finished installing WSL.) You will be at the *Bash prompt*, which looks something like this:

```
user@machine:~$
```

**Warning**

If that prompt instead looks like `root@...#`, something is wrong. Did you create a Unix username and password for Ubuntu in the earlier step above? If so, the username in this prompt should be the username you chose back then, not `root`. *Do not proceed* with these instructions if your prompt looks like `root@...#`. Perhaps you could uninstall Ubuntu and reinstall it.

**Enable copy-and-paste:**

- Click on the Ubuntu icon on the top left of the window.
- Click Properties
- Make sure “Use Ctrl+Shift+C/V as Copy/Paste” is checked.

Now Ctrl+Shift+C will copy and Ctrl+Shift+V will paste into the terminal. Note that you have to include Shift as part of that keystroke.

Run the following command to update the *APT package manager*, which is what helps to install Unix packages:

```
sudo apt update
```

You will be prompted for the Unix password you chose. The prefix `sudo` means to run the command as the administrator, aka “super user”. In other words, do this command as super user, hence, “sudo”.

**Warning**

Running commands with `sudo` is potentially dangerous and should not be done lightly. Do not get into the habit of putting `sudo` in front of commands, and do not randomly try it without reason.

Now run this command to upgrade all the APT software packages:

```
sudo apt upgrade -y
```

Then install some useful packages that we will need:

```
sudo apt install -y zip unzip build-essential tree
```

**File Systems.** WSL has its own filesystem that is distinct from the Windows file system, though there are ways to access each from the other.

- When you launch Ubuntu and get the $ prompt, you are in the WSL file system. Your home directory there is named `~`, which is a built-in alias for `/home/your_ubuntu_user_name`. You can run `explorer.exe .` (note the dot at the end of that) to open your Ubuntu home directory in Windows explorer.
- From Ubuntu, you can access your Windows home directory at the path `/mnt/c/Users/your_windows_user_name/`.
- From Windows Explorer, you can access your Ubuntu home directory under the Linux icon in the left-hand list (near “This PC” and “Network”), then navigating to Ubuntu → `home` → `your_ubuntu_user_name`. Or you can go there directly by typing into the Windows Explorer path bar: `\\wsl$\Ubuntu\home\your_ubuntu_user_name`.

Practice accessing your Ubuntu and Windows home directories now, and make sure you can recognize which you are in. For advanced information, see Microsoft’s [guide to Windows and Linux file systems](https://docs.microsoft.com/en-us/windows/wsl/filesystems).

We recommend storing your OCaml development work in your Ubuntu home directory, not your Windows home directory. By implication, Microsoft also recommends that in the guide just linked.

*End of Clarkson@Cornell 3110 Windows Setup Instructions*

---

> + **These Instructions are cribbed in part from Cornell's CS3110 Spring 2020**
> + **These instructions presume that you are running Windows 11 or Windows 10 with Version 2004 or more recent. If you are running an earlier version of Windows, these instructions won't work.**
> + These instructions are rather lengthy and detailed. It's important to follow them carefully. Contact a course staffer if you run into problems.

The basic idea is to make use of the Windows Subsystem for Linux (WSL) and Microsoft's vscode editor. Our setup has 5 parts:

1. Enable Windows Subsystem for Linux (WSL2) and Install the Ubuntu Linux System
2. Set up your Work Area
3. Set up the Basic OCaml Ecosystem
4. Add Support for Graphical Applications
5. Install and Configure the vscode Editor

### 1. **Update Ubuntu** [About 4 mintes] 

Software is generally deployed in *packages* and most systems have tools for managing packages. One of the more widely used package managers in the Unix environment is the *advanced packaging tool* `apt`. Enter the following command into the shell:

5. ```bash
   sudo apt update
   ```
   You'll be prompted for the UNIX password you chose earlier. The command `apt update` updates the list of packages managed by `apt` on your system. The prefix `sudo` tells Unix to run the  `apt udate` command as the *system administrator*, aka *super user*.
   
   > Heads up!  Running Unix commands with `sudo` is potentially dangerous and should't be done lightly. Do not get into the habit of putting `sudo` in front of commands.
   
   Now run the `apt upgrade` command to actually upgrade all the `apt` software packages; this took about 3 minutes on my system. If you're prompted about configuring libssl, just hit Enter to accept the default choices.
   ```bash
   sudo apt ungrade -y
   ```
6. **Install a few other Unix Packages** [About 7 minutes] Several of the OCaml tools that we'll be using rely on lower-level operating system tools and packages. Install these as follows. Generally speaking, you should respond affirmatively when prompted.
   ```bash
   sudo apt install m4 pkg-config libcairo2-dev libgnomecanvas2-dev tree unzip
   ```

   At this point, you can run a “bare-bones” Ubuntu Unix terminal as an application within your WSL system. It's worth noting that as of this writing, WSL doesn't install any support for graphics of any kind including the graphical user interfaces (GUIs) that you're accustomed to.

### 2. Set up your Work Area

WSL has its own file system that is distinct from the Windows file system. You can edit Windows files from WSL, but you cannot edit WSL files from Windows. For more information about the differences between the Windows and WSL filesystems, and how to work with them, see [this guide](https://github.com/michaeltreat/Windows-Subsystem-For-Linux-Setup-Guide/blob/master/readmes/03_understanding_the_file_systems.md).

Most operating systems use a tree-structured hierarchy of *directories* (aka *folders*) for organizing resources. Each user is assigned a *home directory* where they can organize their files and subdirectories. When a user is interacting with the operating system via a command shell, in addition to a home directory, the user will also have a *current working directory*. The home directory is fixed but it's common for the current working directory to change as we interact with the shell. In the Ubuntu shell, type the *print working directory* command `pwd`

```bash
pwd
```

This will display a string called a *file path* which specifies the sequence of directories leading to the current working directory. For me, it shows the file path  `/home/muller`. This indicates that my Unix home directory is `muller` and the path to that home directory is `/home/muller/`.

> Pro tip: The tilde character `~` can be used as an abbreviation of the path to your home directory.

My Windows home directory is elsewhere, back to that in a minute.

One can make a subdirectory of the current working directory using the *make directory* command `mkdir`. Let's make a directory to hold the materials in this course, type

```bash
mkdir csci1103
```

We'll call this the *course home directory*. One can see what files and directories are contained within a directory using the *list* command `ls`. Typing

```bash
ls
```

will show that the directory `/home/muller` now contains one item, the subdirectory `csci1103`. The current working directory can be changed via the *change directory* command `cd`. Typing

```bash
cd csci1103
```

> Pro tip: Instead of typing out all of the letters in `csci1103`, you can just type the first letter `c` and then hit the `tab` key and the command shell will finish it for you. A great time saver.

Now use the `pwd` command to confirm that the current working directory is `/home/muller/csci1103`. To be clear, the *home directory* is still `/home/muller`. If we want to "return" to our home directory, all 4 of these options will do it:

```bash
1. cd /home/muller
2. cd ~        # remember that ~ is an abbreviation for the file path /home/muller
3. cd
4. cd ..       # means set the current working directory to the parent directory, 
               # i.e., move up one level
```

Note that you can always move to the home directory for this course by typing `cd ~/csci1103`.

You can access your Windows home directory from WSL Linux via the path `/mnt/c/Users/YOUR_WINDOWS_NAME/` where `YOUR_WINDOWS_NAME` is your Windows username. It's convenient to make a link for it, so you could access it quickly, for instance, calling it `windows`. This is how to create such a link:

 ```bash
cd
ln -s /mnt/c/Users/YOUR_WINDOWS_NAME/ windows    # NOTE THE SPACE!
 ```

Now you can navigate to your Windows home directory from your Ubuntu command shell by typing `cd ~/windows` and to your course home directory by typing `cd ~/csci1103`.
### 3. Set up the Basic OCaml Ecosystem

The OCaml ecosystem has 3 major parts:

1. A suite of compilers and interpreters implementing the OCaml programming language;
2. A *package manager* called [opam](https://opam.ocaml.org/); this manages libraries of OCaml code.
3. A *build manager* called [dune](https://dune.build/); this manages the compilation, linking and execution of OCaml code.

2. Install the OCaml package manager `opam`. 

   ```bash
   sudo apt install opam
   ```
   
   > If this doesn't work, get in touch with the instructor.

3. Initialize the `opam` package manager:

   ```bash
   opam init --bare -a -y
   ```

   > **Heads up! The two quote marks in the `eval` command below are *backquotes* (upper left, below the `esc` key).**

   ```bash
   eval `opam config env`
   ```

   Exit the Ubuntu shell and restart Ubuntu.

4. Installing and initializing opam also installs the OCaml compiler `ocamlc` and the OCaml interpreter `ocaml`. Fire up the interpreter by typing its name

   ```bash
   ocaml
   ```

   You should see something like this

   ![a](./img/ocamlREPL.png)

   > It's fine if you see OCaml version 4.8

   Type in an arithmetic expression or two, each followed by two consecutive semicolons `;;`. Type `ctrl-d` to exit the interpreter.

4. Now we'll retrieve some configuration tools from the course GitHub site.

   ```bash
   cd ~/csci1103
   git clone https://github.com/BC-CSCI1103/setup.git
   ```

   > Pro tip: Typing the `ls` command will show you that you now have a directory called `setup`, but if you want to see what the directory contains, try the newly installed `tree` command. You should see something like
   >
   > <img src="./img/tree.png" width=600px>

5. **Configure** [About 7 Minutes] Execute the course `configure` script to install several OCaml packages: `dune`, `merlin`, `animate`, etc. Type `Y` to accept the installation.

   ```bash
   cd ~/csci1103/setup
   ./configure
   ```

6. Now test the basic installation. Use the `dune` build manager to compile and run the sample `hello` program as follows:

7. ```bash
   cd ~/csci1103/setup/test/hello/src
   dune exec bin/main.exe
   ```

   If you see *"Hello World!"*, great! Press on. If you don't, something is amiss, contact a course staffer.

---

*Start of Copied from Clarkson@Cornell*

**Double Check OCaml**

If you’re having any trouble with your installation, follow these double-check instructions. Some of them repeat the tips we provided above, but we’ve put them all here in one place to help diagnose any issues.

First, reboot your computer. We need a clean slate for this double check.

Second, run utop, and make sure it works. If it does not, here are some common issues:

Are you in the right Unix prompt? On Mac, make sure you are in whatever Unix shell is the default for your Terminal: don’t run bash or zsh or anything else manually to change the shell. On Windows, make sure you are in the Ubuntu app, not PowerShell or Cmd.

Is the OPAM environment set? If utop isn’t a recognized command, run eval $(opam env) then try running utop again. If utop now works, your login shell is somehow not running the right commands to automatically activate the OPAM environment; you shouldn’t have to manually activate the environment with the eval command. Probably something went wrong earlier when you ran the opam init command. To fix it, follow the “redo” instructions below.

Is your switch listed? Run opam switch list and make sure a switch named cs3110-2022fa is listed, that it has the 4.14.0 compiler, and that it is the active switch (which is indicated with an arrow beside it). If that switch is present but not active, run opam switch cs3110-2022fa then see whether utop works. If that switch is not present, follow the “redo” instructions below.

Redo Instructions: Remove the OPAM directory by running `rm -r ~/.opam`. Then go back to the OPAM initialization step in the instructions way above, and proceed forward. Be extra careful to use the exact OPAM commands given above; sometimes mistakes occur when parts of them are omitted. Finally, redo the double check: reboot and see whether utop still works.

**Important**

You want to get to the point where utop immediately works after a reboot, without having to type any additional commands.

*End of Copied from Clarkson@Cornell*

---

### 4. Add Support for Graphical Programs

The configuration developed so far is fine for running OCaml programs on WSL. But WSL doesn't provide support for graphical applications. In order to run graphical applications under WSL, we'll need to install a windowing system. We'll use the tried and true X-Windows system, aka *X11*,  (which isn't related to Microsoft Windows). In order to use it, we'll have to complete 2 steps:

1. Install *server* software for X-Windows, a so-called X-server;
2. Configure our Unix command shell (i.e., bash) to tell graphical applications to use the newly installed X-server.

#### Install the VcXsrv X-server

There are many X-servers out there, for this course we'll use [VcXsrv](https://sourceforge.net/projects/vcxsrv/). Download and install it (using your Windows browser). The VcXsrv server includes a window launcher utility called *XLaunch*. Find the XLaunch shortcut on the Desktop or in the Start Menu, and click it. You'll be greeted by a simple setup wizard. Accept the default options on the first two pages (i.e., *Multiple windows* then *Start no client*). **On page 3, select the *Disable access control* check box.**

![panel3](./img/xsrvpanel3.png)

You can always start the X-server by double-clicking its icon. If you don't want the hassle, on page 4 of the setup wizard, select the ***Save configuration*** button. This will display a Save configuration page that will allow you to save the choices you just made in a configuration file called `config.xlaunch`. Save it in the default choice `Documents`. Now use the Unix `cd` and *move* command `mv` to move the `config.xlaunch` file to the Windows Startup area as follows:

```bash
cd ~/windows
mv Documents/configure.xlaunch AppData/Roaming/Microsoft/Windows/Start\ Menu/Programs/Startup/
```

Having saved your `config.xlaunch` file in the `Startup` directory as shown, the X-server will start automatically for you on system startup and you won't have to hassle with starting it by hand anymore. Once the X-server is launched, an X icon will appear in your system tray. If you want to run a graphical application and you don't see the X icon in the starter tray, you can start the X-server by hand by double-clicking the XLaunch icon.

#### Configure the Command Shell to use the X-server

In an Ubuntu command shell, carefully type or cut and paste the following:

```bash
cd
echo "export DISPLAY=localhost:0.0" >> .bash_profile
echo "eval $(opam env)" >> .bash_profile
source .bash_profile
```

These commands insert two command lines into your `.bash_profile` file in your Unix home directory. The commands in the `.bash_profile` file are executed every time you start up an Ubuntu command shell.

#### Test a Graphical Application

OK, are we good to go? Let's try a graphical application. Type

```bash
cd ~/csci1103/setup/test/stopNgo/src
```

Now use the `dune` build manager to build and run the `stopNGo` program:

```bash
dune exec bin/main.exe
```

If you have trouble with any of the above steps, get in touch with course staff.

### 5. Install and Configure the vscode Editor

You made it this far, great job! The last step is to install Microsoft's **vscode** editor. Once this is setup, we'll be running vscode from an Ubuntu shell by typing the command

```bash
code .
```

meaning, fire up vscode and have it open the current working directory. This will start vscode from the command line. Note that from WSL/Ubuntu we are running vscode which was installed in Windows. 

---

*Start of Mostly Clarkson@Cornell*

Visual Studio Code is a great choice as a code editor for OCaml. (Though if you are already a power user of Emacs or Vim those are great, too.)

First, download and install [Visual Studio Code](https://code.visualstudio.com/) (henceforth, VS Code). 

Launch VS Code. Then open the extensions pane, either by going to View → Extensions, or by clicking on the icon for it in the column of icons on the left — it looks like four little squares, the top-right of which is separated from the other three.

Next, install the “**Remote - WSL**” extension. Then open a WSL window by using the command “Remote-WSL: New WSL Window”. The first time you do this, it will install some additional software. After that completes, you will see a green “WSL: Ubuntu” indicator in the bottom-left of the VS Code window. **Make sure that you see “WSL: Ubuntu” there before proceeding with the instructions below.** If you see just an icon that looks like >< then click it, and choose “New WSL Window” from the Command Palette that opens.

Third, close any open terminal shells — or just logout or reboot — to let the new path settings take effect, so that you will later be able to launch VS Code from the terminal.

Fourth, again open the VS Code extensions pane. Search for and install the “**OCaml Platform**” extension from OCaml Labs. Be careful to install the extension with exactly that name. (If you happen to note a “build failing” icon on the extension’s page, don’t be concerned.)

**Warning**

The extensions named simply “OCaml” or “OCaml and Reason IDE” are not the right ones. They are both deprecated.

**Warning**

When you install the OCaml Platform extension make sure to use the button that says “**Install in WSL: Ubuntu**”, not with a button that says only “Install”. If you’ve already done the latter, that’s okay; but, you need to also install on WSL. If you can’t find a button that says “Install in WSL” then you probably do not have the green “WSL: Ubuntu” indicator at the bottom-left of your VS Code window, either. Follow the instructions above to open a WSL window. From there, try again to install the OCaml Platform extension using the “Install in WSL” button.

**Double Check VS Code**

Let’s make sure VS Code’s OCaml support is working.

Reboot your computer again. (Yeah, that really shouldn’t be necessary. But it will detect so many potential mistakes now that it’s worth the effort.)

Open a fresh new Unix shell. Windows: remember that’s the Ubuntu, not PowerShell or Cmd. Mac: remember that you shouldn’t be manually switching to a different shell by typing zsh or bash.

Navigate to a course home directory `/home/YOURUSERNAME/csci1103`In that directory open VS Code by running:

```bash
code .
```


Go to File → New File. Save the file with the name test.ml. VS Code should give it an orange camel icon.

Type the following OCaml code then press Return/Enter:

```ocaml
let x : int = 3110
```


As you type, VS Code should colorize the syntax, suggest some completions, and add a little annotation above the line of code. Try changing the int you typed to string. A squiggle should appear under 3110. Hover over it to see the error message. Go to View → Problems to see it there, too. Add double quotes around the integer to make it a string, and the problem will go away.

If you don’t observe those behaviors, something is wrong with your install. Here’s how to proceed:

Make sure that, from the same Unix prompt as which you launched VS Code, you can successfully complete the double-check instructions for your OPAM switch: can you run utop? is the right switch active? If not, that’s the problem you need to solve first. Then return to the VS Code issue. It might be fixed now.

If you’re on WSL and VS Code does add syntax highlighting but does not add squiggles as described above, and/or you get an error about “Sandbox initialization failed”, then double-check that you see a green “WSL” indicator in the bottom left of the VS Code window. If you do not, make sure you installed the “Remote - WSL” extension as described above, and that you are launching VS Code from Ubuntu rather than PowerShell or from the Windows GUI.

If you’re still stuck with an issue, try uninstalling VS Code, rebooting, and re-doing all the install instructions above from scratch. Pay close attention to any warnings or errors.

**Warning**

While troubleshooting any VS Code issues, do not hardcode any paths in the VS Code settings file, despite any advice you might find online. That is a band-aid, not a cure of whatever the underlying problem really is. More than likely, the real problem is an OCaml environment issue that you can investigate with the OCaml double-check instructions above.

**VS Code Settings**
We recommend tweaking a few editor settings. Open the user settings JSON file by (i) going to View → Command Palette, (ii) typing “user settings json”, and (iii) selecting Open User Settings (JSON). Copy and paste these settings into the window:

```
{
    "editor.tabSize": 2,
    "editor.rulers": [ 80 ],
    "editor.formatOnSave": true
}
```


Save the file and close the tab.

*End of Mostly from Clarkson@Cornell Instructions*

---

So now we have the development process:

1. Open a command shell in Ubuntu;

2. Use the Unix `cd` command to navigate to the `src` directory of the project that you're working on;

   ```bash
   cd ~/csci1103/ps1-dogfishbar/src             # for example
   ```

3. fire up `vscode` from WSL by issuing the Unix command

   ```bash
   code .
   ```

4. Write your OCaml code;

5. When your code seems worth testing (i.e., merlin isn't flagging errors) and you think it might be reasonable, use `dune` to build and run it:

   ```bash
   dune exec bin/main.exe
   ```

6. If it works, great! For submission instructions, read on. If your code doesn't work, return the the editor...

---

## Finishing up the Workflow

Back to the problem set. Whether you're using Windows or MacOS, you can make a local *clone* of your problem set repository on your laptop. Fire up your web browser and visit the course website `https://github.com/BC-CSCI1103/` and scroll down to your repo for pset 1 (mine would be called `ps1-dogfishbar`). Select the green **Clone or download** button.

![clone](./img/clone.png)

Copy the web URL of the repo to your clipboard. Then, fire up a Unix command shell and make a local clone of the repo by typing the `git clone` command:

```bash
cd ~/csci1103
git clone https://github.com/BC-CSCI1103/ps-demo-dogfishbar.git
```

Of course, rather than `ps-demo-dogfishbar.git`, the rightmost bit for you will have something like `ps1-smith.git` rather than `ps-demo-dogfishbar.git`. The `git clone` command  will cause the `git` and `GitHub` systems to make a local copy of your remote (master) repo. The repo for ps1 has four items:

1. a writeup in the form of this `README.md` file,
2. a hidden `.gitignore` file,
3. an `img/` folder containing the images shown above, and
4. a `src/` folder for code. A `src/` folder will usually have a `dune-project` file and a `bin` directory. The `bin` directory will typically have OCaml "harness" code — code that isn't finished.

The distributed source code should always compile and run. Type

```bash
cd ~/csci1103/ps1-YOUR_GITHUB_ID/src/
dune exec bin/main.exe
```

The unix `dune` command builds (i.e., compiles and links) executable code. All of the projects for this course will be distributed with working `dune` files.

### Wrapping Up

To review, you'll use the [vscode](https://code.visualstudio.com/) text editor to develop your problem set solutions and you'll use `dune` to compile and test your work. As you work on your code, you should use Unix's `git` commands `git add` and `git commit` to commit your work to your local git repository periodically.

When your code is working (and looks great!) you can submit it for grading using `git push` to transfer your local working repository to your master problem set repository on the Github course website.

```bash
cd ~/csci1103/ps1-YOUR_GITHUB_ID/
... edit ... git add ... git commit ...
git push
```

After reviewing your work, course staff will leave comments and record your problem set score in the local BC [gradebook on Canvas](https://bostoncollege.instructure.com/courses/1634611/).
